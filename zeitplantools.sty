
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Makros & Co fuer das Schmieden von ausgekluegelten Zeitplaenen
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% $Log: zeitplan_tools.tex,v $
% Revision 1.1  2002/10/14  14:56:06  schmittt
% Initial revision
%
% Revision 1.4  1997/04/24 14:44:28  hauck
% kleinere Formataenderungen
%
% Revision 1.3  1997/04/18 10:53:39  hauck
% Herumfeilen an der Optik
%
% Revision 1.2  1997/04/18 09:18:57  hauck
% Funktionierende Zwischenversion ;-)
%
% Revision 1.1  1997/04/17 19:31:23  hauck
% Makros & Co fuer einen ausgekluegelten Zeitplan :-)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{supertabular}

\newcommand{\NumMonths}{36}

\newcommand{\NumMonthsReciprocally}{0.04}    % 1/36, z.B.

\newlength{\TimeplanWidth}
\setlength{\TimeplanWidth}{0.6\textwidth}
\newlength{\CaptionWidth}
\setlength{\CaptionWidth}{4.2cm}
\newlength{\SubCaptionWidth}
\setlength{\SubCaptionWidth}{3.8cm}
\newlength{\XTimeplanWidth}
\setlength{\XTimeplanWidth}{9.8cm}%{0.7\textwidth}
\newlength{\XCaptionWidth}
\setlength{\XCaptionWidth}{4.4cm}

\newlength{\HalfYearWidth}
\setlength{\HalfYearWidth}{1.2cm}


\newlength{\MonthWidth}
\setlength{\MonthWidth}{0.028\TimeplanWidth}

\newsavebox{\MonthBox}
\sbox{\MonthBox}{\framebox[\MonthWidth]{\rule{0mm}{2mm}}}

\newsavebox{\FirstHalfYearBox}
\sbox{\FirstHalfYearBox}{\framebox[6\MonthWidth]{\rule{0mm}{2mm} 1-6}}

\newsavebox{\SecondHalfYearBox}
\sbox{\SecondHalfYearBox}{\framebox[6\MonthWidth]{\rule{0mm}{2mm} 7-12}}

\newsavebox{\ThirdHalfYearBox}
\sbox{\ThirdHalfYearBox}{\framebox[6\MonthWidth]{\rule{0mm}{2mm} 13-18}}

\newsavebox{\FourthHalfYearBox}
\sbox{\FourthHalfYearBox}{\framebox[6\MonthWidth]{\rule{0mm}{2mm} 19-24}}

\newsavebox{\FifthHalfYearBox}
\sbox{\FifthHalfYearBox}{\framebox[6\MonthWidth]{\rule{0mm}{2mm} 25-30}}

\newsavebox{\SixthHalfYearBox}
\sbox{\SixthHalfYearBox}{\framebox[6\MonthWidth]{\rule{0mm}{2mm} 31-36}}

\newsavebox{\HalfYearBoxes}
\sbox{\HalfYearBoxes}{\usebox{\MonthBox}\usebox{\MonthBox}%
  \usebox{\MonthBox}\usebox{\MonthBox}\usebox{\MonthBox}\usebox{\MonthBox}}

\newsavebox{\TimeplanBoxes}
\sbox{\TimeplanBoxes}{\usebox{\HalfYearBoxes}\usebox{\HalfYearBoxes}%
  \usebox{\HalfYearBoxes}\usebox{\HalfYearBoxes}\usebox{\HalfYearBoxes}%
  \usebox{\HalfYearBoxes}
}

\newsavebox{\MonthCountBoxes}
\sbox{\MonthCountBoxes}{\usebox{\FirstHalfYearBox}\usebox{\SecondHalfYearBox}%
  \usebox{\ThirdHalfYearBox}\usebox{\FourthHalfYearBox}%
  \usebox{\FifthHalfYearBox}\usebox{\SixthHalfYearBox}
}

\newcommand{\TimeplanRule}[3]{%
  \parbox[t]{\CaptionWidth}{\raggedright #1\\*[0.1cm]} &
  \hspace*{#2\MonthWidth}\rule{#3\MonthWidth}{1.2ex} \\
}

\newcommand{\TimeplanSubRule}[3]{%
  - \parbox[t]{\SubCaptionWidth}{\raggedright #1\\} &
  \hspace*{#2\MonthWidth}\rule{#3\MonthWidth}{1.2ex} \\
}

\newcommand{\TimeplanCaption}[1]{%
  \parbox[t]{\CaptionWidth}{\raggedright #1\\*[0.2cm]} & \\
}


\newcommand{\TimeplanChapter}[1]{%
  \hline
  \multicolumn{2}{|l|}{\rule[-3mm]{0pt}{8mm}\raggedright\normalsize\bf #1} \\ 
  \hline
}

\newcommand{\TimeplanComment}[1]{%
  \multicolumn{2}{|c|}{\em #1} \\
  \hline
}


\newenvironment{Timeplan}
{

  \tablefirsthead{
    \hline
%     \raisebox{-1ex}[0pt][-1ex]{\bf Zeitplan (in Monaten)} &
    \raisebox{-1ex}[0pt][-1ex]{\bf Timeplan (in Months)} &
     \usebox{\MonthCountBoxes} \\
     & \usebox{\TimeplanBoxes} \\
    \hline
  }

  \tablehead{
%     \hline
%     \raisebox{-1ex}[0pt][-1ex]{\bf Zeitplan (in Monaten)} &
%       \usebox{\MonthCountBoxes} \\
%     & \usebox{\TimeplanBoxes} \\
%     \hline
  }

%  \tabletail{
%    \hline
%    \multicolumn{2}{|r|}{\small \it Fortsetzung n\"achste Seite} \\
%    \hline
%  }

  \tablelasttail{
    \hline
  }


  \begin{center}
  \small \noindent

  \begin{supertabular}%
  {|p{\XCaptionWidth}||p{\XTimeplanWidth}| }
}
{
  \end{supertabular}
  \end{center}
}

